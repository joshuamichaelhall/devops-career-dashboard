# Security Documentation

This document provides details about the security features implemented in the DevOps Career Dashboard and best practices for secure deployment.

## Privacy and Data Ownership

The DevOps Career Dashboard is designed to ensure that **only you can update your own dashboard** while allowing others to use the codebase without compromising your personal data:

1. **Data Isolation**: Your personal dashboard data is never included in the repository
2. **Configuration Privacy**: Sensitive configuration is stored in `.env` files excluded via `.gitignore`
3. **Authentication-Protected Updates**: Only users with admin credentials can modify dashboard data
4. **Clean Repository**: When someone clones this repo, they get only code, not your personal data

This design ensures you maintain full control over your career data while still allowing the community to benefit from the dashboard's functionality.

## Authentication System

The dashboard uses a JWT (JSON Web Token) based authentication system with the following features:

1. **Secure Password Storage**:
   - Passwords are hashed using bcrypt with a work factor of 10
   - Password hashes are stored in the .env file, not in the database
   - Initial admin setup is done through a secure CLI tool

2. **Token Management**:
   - JWTs expire after 24 hours by default
   - Tokens are validated on every protected API request
   - User roles are encoded in the token for authorization

3. **Protected Routes**:
   - All data modification endpoints require authentication
   - Admin-only actions (like update scripts) require admin role
   - Public routes are limited to basic information

## API Key Security

The dashboard securely handles Clay API keys and other sensitive credentials:

1. **Encrypted Storage**:
   - API keys are encrypted using AES-256-GCM
   - Encryption key is stored in environment variables
   - Each encrypted value uses a unique salt and IV

2. **Key Management**:
   - Preferred method is environment variables
   - Fallback to encrypted file storage if environment variables aren't available
   - Keys are never exposed to frontend code

3. **Secure Proxy Architecture**:
   - Frontend never directly calls external APIs
   - All external API requests are proxied through the backend
   - External API keys are applied server-side

## Data Protection

1. **Input Validation**:
   - All user inputs are validated before processing
   - JSON payloads are validated for expected structure
   - API endpoints check for required fields

2. **Automated Backups**:
   - Data files are automatically backed up before modifications
   - Backup rotation keeps the last 10 versions
   - Backups are stored in the same directory as the original files

3. **Error Handling**:
   - Errors are logged but sensitive details are not exposed to users
   - Generic error messages are shown to users
   - Detailed error information is logged server-side

## Network Security

1. **HTTPS Enforcement**:
   - Production mode can enforce HTTPS-only communication
   - HTTP requests are redirected to HTTPS when enabled
   - Managed through the REQUIRE_HTTPS environment variable

2. **Rate Limiting**:
   - General API rate limiting to prevent abuse
   - Stricter limits on authentication endpoints to prevent brute force attacks
   - Configurable through environment variables

3. **HTTP Headers**:
   - Helmet.js provides secure HTTP headers
   - Content Security Policy to prevent XSS attacks
   - CORS headers to control API access

## Secure Deployment Recommendations

For the most secure production deployment that ensures only you can update your dashboard:

1. **Environment Setup**:
   ```
   # Required security settings
   JWT_SECRET=<generate a random string>
   ENCRYPTION_KEY=<generate a random string>
   ADMIN_USERNAME=<your admin username>
   ADMIN_PASSWORD_HASH=<generated by setup-admin.js>
   
   # External API keys (preferred over config files)
   CLAY_API_KEY=<your Clay API key>
   
   # Production security settings
   NODE_ENV=production
   REQUIRE_HTTPS=true
   ENABLE_RATE_LIMITING=true
   ```

2. **Server Configuration**:
   - Run behind a reverse proxy like Nginx
   - Set up proper SSL certificates
   - Configure proper file permissions

3. **Regular Updates**:
   - Keep all dependencies up to date
   - Use npm audit to check for vulnerabilities
   - Apply security patches promptly

## Security Hardening Checklist

Before deploying to production:

- [ ] Run `npm run secure-setup` to generate encryption key and create admin user
- [ ] Set a strong password for the admin account
- [ ] Configure environment variables in a secure way (not in version control)
- [ ] Enable HTTPS enforcement
- [ ] Enable rate limiting
- [ ] Test authentication and authorization functionality
- [ ] Verify API key encryption is working
- [ ] Check file permissions on server files